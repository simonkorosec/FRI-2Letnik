50+6
x <- 945
x
x = 5
y <- 3
4 -> z
z
ls
ls()
rm(x)
ls()
x <- c(5,2,7,4)
x
z <- c(T,F,T)
z
w <- c("bla", "zdravo, "hojmene")
w <- c("bla","zdravo,"hojmene")
w<-c("bla","zdravo,"hojmene")
w<-c("bla","zdravo","hojmene")
w
v <- 1:10
v
rm(ls())
rm(list=ls())
ls()
v <- seq(from=5,to=50, by=3)
v
x <- 522
a <- c(v,x, 5.3)
a
rm(list=ls())
x <- 1:4
y <- c(10,20,30,40)
x+y
x+1
v <- c(2,3)
x+v
v+y
x <- c(10,-20,30,-40,50)
x > 0
sqrt(c(1,4,9,16))
lenght(x)
length(x)
sort(x)
x[2]
x[c(1,3)]
x[1:3]
x[-1]
x[c(-1,-)]
x[c(-1,-4)]
x[x > 0]
x[x < 0 & x > -40]
x[2] <- -25
x
x[c(4,5)] <- c(-45,-55)
x
x[x<0] <- 0
x
x[x<0] <- -20
x
x[x<1] <- -20
x
x[x<0] <- c(0,1)
x[x<0] <- c(0,1,3)
x
rm(x[x<2])
x <- x[x<2]
x
x <- c(10,-20,30,-40,50)
x
x[g
]
x[]
x <-5
x
x <- c(10,-20,30,-40,50)
x[] <- 5
x
student <- list(id=12345,name="Marko",marks=c(10,9,10,9,8,10))
student
clear
clear()
name <- c("Tom", "Mary", "Anna")
age <- c(51,47,19)
gender <- c("m", "f", "f")
student <- c(F,F,T)
data.frame(name,age,gender,student)
df <-data.frame(name,age,gender,student)
df
df[3,2]
df[3]
df[c(1,2),3]
df[1,c(1,2)]
df[1,c(1,3)]
df[-1, c(1,3)]
df[,1]
df[2,2]
df[2,1]
df[,"name"]
df$name
df$name,age
q()
v <- 1:20
v
k <- 20:1
k
v <- c(v,k)
v
k <- 19:1
v <- 1:20
v <- c(v,k)
v <- c(v,k)
k <- 19:1
v <- 1:20
v <- c(v,k)
v
clear
v <- c(1,3,5)
k <- rep(v, times = 10)
k
ls(9
)
ls()
rm(list = ls())
ls()
gender <- c("f","m","m","m","f","m","f")
gender
gender <- factor(gender)
gender
smeri <- factor(c('levo','levo','desno'), levels = c('levo','desno','gor','dol'))
smeri
tocke <- seq(start=0, to=1, step=0.1)
tocke <- seq(from=0, to=1, by=0.1)
tocke
tocke
x <- 5
sin(x)
sin(tocke)
height <- c(179, 185, 183, 172, 174, 185, 193, 169, 173, 168)
weight <- c(95, 89, 70, 80, 92, 86, 100, 63, 72, 70)
bmi <- wiight / (height / 100)^2
bmi <- weight / (height / 100)^2
bmi
lenght(bmi)
length(bmi)
x <- c(1, -2, 3, -4, 5, -6, 7, -8)
x[x > 0]
x[x > 0] * 10
x <- c(1,2,3)
x[1]/x[2]^2-1+2*x[3]-x[1+1]
x <- 1:200
length(x[x %% 11 == 0])
q()
gcd(5,8)
q()
pod <- read.table("podatkiSem1.txt", sep=",", header=T)
getwd()
pod <- read.table("podatkiSem1.txt", sep=",", header=T)
pod$Glob_sevanje_min <- NULL
pod$O3 <- cut(pod$O3, c(-Inf, 60, 120, 180, Inf), labels=c("NIZKA", "SREDNJA", "VISOKA", "EKSTREMNA"))
pod$PM10 <- cut(pod$PM10, c(-Inf,35,Inf),labels=c("NIZKA","VISOKA"))
pod$Glob_sevanje_min <- NULL
pod$Datum <- as.Date(pod$Datum, "%Y-%m-%d")
pod$Mesec <- months(pod$Datum)
pod$Mesec <- as.factor(pod$Mesec)
pod$Dan   <- weekdays(pod$Datum)
pod$Dan <- as.factor(pod$Dan)
pod$Datum <- NULL
sel <- sample(1:nrow(pod), size=as.integer(nrow(pod)*0.7), replace=F)
learn <- pod[sel,]
test <- pod[-sel,]
modelDT <- CoreModel(PM10 ~ ., learn, model="tree")
modelNB <- CoreModel(PM10 ~ ., learn, model="bayes")
modelKNN <- CoreModel(PM10 ~ ., data = learn, model="knn", kInNN = 7)
library(CORElearn)
modelDT <- CoreModel(PM10 ~ ., learn, model="tree")
modelNB <- CoreModel(PM10 ~ ., learn, model="bayes")
modelKNN <- CoreModel(PM10 ~ ., data = learn, model="knn", kInNN = 7)
source("mojefunkcije.R")
predDT <- predict(modelDT, test, type = "class")
caDT <- CA(test$O3, predDT)
caDT
sel <- sample(1:nrow(pod), size=as.integer(nrow(pod)*0.7), replace=F)
learn <- pod[sel,]
test <- pod[-sel,]
predDT <- predict(modelDT, test, type = "class")
caDT <- CA(test$O3, predDT)
caDT
predNB <- predict(modelNB, test, type="class")
caNB <- CA(test$O3, predNB)
caNB
predKNN <- predict(modelKNN, test, type="class")
caKNN <- CA(test$O3, predKNN)
caKNN
modelDT <- CoreModel(PM10 ~ Sunki_vetra_max + Padavine_mean + Padavine_sum + Temperatura_lokacija_max + Temperatura_lokacija_min, learn, model="tree")
modelNB <- CoreModel(PM10 ~ Sunki_vetra_max + Padavine_mean + Padavine_sum + Temperatura_lokacija_max + Temperatura_lokacija_min, learn, model="bayes")
modelKNN <- CoreModel(PM10 ~ Sunki_vetra_max + Padavine_mean + Padavine_sum + Temperatura_lokacija_max + Temperatura_lokacija_min, data = learn, model="knn", kInNN = 7)
modelDT <- CoreModel(PM10 ~ ., learn, model="tree")
modelNB <- CoreModel(PM10 ~ ., learn, model="bayes")
modelKNN <- CoreModel(PM10 ~ ., data = learn, model="knn", kInNN = 7)
predDT <- predict(modelDT, test, type = "class")
caDT <- CA(test$PM10, predDT)
caDT
predNB <- predict(modelNB, test, type="class")
caNB <- CA(test$PM10, predNB)
caNB
predKNN <- predict(modelKNN, test, type="class")
caKNN <- CA(test$PM10, predKNN)
caKNN
modelDT <- CoreModel(PM10 ~ Sunki_vetra_max + Padavine_mean + Padavine_sum + Temperatura_lokacija_max + Temperatura_lokacija_min, learn, model="tree")
modelNB <- CoreModel(PM10 ~ Sunki_vetra_max + Padavine_mean + Padavine_sum + Temperatura_lokacija_max + Temperatura_lokacija_min, learn, model="bayes")
modelKNN <- CoreModel(PM10 ~ Sunki_vetra_max + Padavine_mean + Padavine_sum + Temperatura_lokacija_max + Temperatura_lokacija_min, data = learn, model="knn", kInNN = 7)
predDT <- predict(modelDT, test, type = "class")
caDT <- CA(test$PM10, predDT)
caDT # 0,88
predNB <- predict(modelNB, test, type="class")
caNB <- CA(test$PM10, predNB)
caNB # 0,79
predKNN <- predict(modelKNN, test, type="class")
caKNN <- CA(test$PM10, predKNN)
caKNN # 0,89
pod$Datum
zima <- pod$Mesec == "februar" | pod$Mesec == "januar" | pod$Mesec == "december"
pomlad <- pod$Mesec == "marec" | pod$Mesec == "april" | pod$Mesec == "maj"
poletje <- pod$Mesec == "junij" | pod$Mesec == "julij" | pod$Mesec == "avgust"
jesen <- pod$Mesec == "september" | pod$Mesec == "oktober" | pod$Mesec == "november"
pod$Letni_cas[zima] <- "zima"
pod$Letni_cas[pomlad] <- "pomlad"
pod$Letni_cas[poletje] <- "poletje"
pod$Letni_cas[jesen] <- "jesen"
pod$Letni_cas <- as.factor(pod$Letni_cas)
modelDT <- CoreModel(PM10 ~ ., learn, model="tree")
modelNB <- CoreModel(PM10 ~ ., learn, model="bayes")
modelKNN <- CoreModel(PM10 ~ ., data = learn, model="knn", kInNN = 7)
predDT <- predict(modelDT, test, type = "class")
caDT <- CA(test$PM10, predDT)
caDT # 0,88 # 0,89
predNB <- predict(modelNB, test, type="class")
caNB <- CA(test$PM10, predNB)
caNB # 0,79 # 0,84
predKNN <- predict(modelKNN, test, type="class")
caKNN <- CA(test$PM10, predKNN)
caKNN # 0,89 # 0,89
modelDT <- CoreModel(PM10 ~ Sunki_vetra_max + Padavine_mean + Padavine_sum + Temperatura_lokacija_max + Temperatura_lokacija_min, learn, model="tree")
modelNB <- CoreModel(PM10 ~ Sunki_vetra_max + Padavine_mean + Padavine_sum + Temperatura_lokacija_max + Temperatura_lokacija_min, learn, model="bayes")
modelKNN <- CoreModel(PM10 ~ Sunki_vetra_max + Padavine_mean + Padavine_sum + Temperatura_lokacija_max + Temperatura_lokacija_min, data = learn, model="knn", kInNN = 7)
predDT <- predict(modelDT, test, type = "class")
predNB <- predict(modelNB, test, type="class")
predKNN <- predict(modelKNN, test, type="class")
caKNN <- CA(test$PM10, predKNN)
caKNN # 0,89 # 0,89
pred <- data.frame(predDT, predNB, predKNN)
pred
voting <- function(predictions)
{
res <- vector()
  for (i in 1 : nrow(predictions))  
{
vec <- unlist(predictions[i,])
    res[i] <- names(which.max(table(vec)))
  }
  factor(res, levels=levels(predictions[,1]))
}
predicted <- voting(pred)
CA(test$PM10, predicted)
predDT.prob <- predict(modelDT, test, type="probability")
predNB.prob <- predict(modelNB, test, type="probability")
predKNN.prob <- predict(modelKNN, test, type="probability")
pred.prob <- caDT * predDT.prob + caNB * predNB.prob + caKNN * predKNN.prob
pred.prob
predicted <- levels(learn$Class)[apply(pred.prob, 1, which.max)]
predicted <- levels(learn$PM10)[apply(pred.prob, 1, which.max)]
CA(test$PM10, predicted)
library(ipred)
bag <- bagging(PM10 ~ ., learn, nbagg=15)
bag.pred <- predict(bag, test, type="class")
CA(test$Class, bag.pred)
CA(test$PM10, bag.pred)
library(randomForest)
install.packages("randomForest")
rf <- randomForest(PM10 ~ ., learn)
predicted <- predict(rf, test, type = "class")
CA(test$PM10, predicted)
install.packages("adabag")
library(adabag)
bm <- boosting(PM10 ~ ., learn)
names(predictions)
predictions <- predict(bm, test)
names(predictions)
predicted <- predictions$class
CA(test$PM10, predicted)
modelDT <- CoreModel(PM10 ~ ., learn, model="tree")
modelNB <- CoreModel(PM10 ~ ., learn, model="bayes")
modelKNN <- CoreModel(PM10 ~ ., data = learn, model="knn", kInNN = 7)
predDT <- predict(modelDT, test, type = "class")
predNB <- predict(modelNB, test, type="class")
predKNN <- predict(modelKNN, test, type="class")
pred <- data.frame(predDT, predNB, predKNN)
predicted <- voting(pred)
CA(test$PM10, predicted)
predDT.prob <- predict(modelDT, test, type="probability")
predNB.prob <- predict(modelNB, test, type="probability")
predKNN.prob <- predict(modelKNN, test, type="probability")
pred.prob <- caDT * predDT.prob + caNB * predNB.prob + caKNN * predKNN.prob
predicted <- levels(learn$PM10)[apply(pred.prob, 1, which.max)]
CA(test$Class, predicted)
CA(test$PM10, predicted)
bag <- bagging(PM10 ~ ., learn, nbagg=15)
bag.pred <- predict(bag, test, type="class")
CA(test$PM10, bag.pred)
qbag.pred <- predict(bag, test, type="class")
bag.pred <- predict(bag, test, type="class")
CA(test$PM10, bag.pred)
bm <- boosting(PM10 ~ Sunki_vetra_max + Padavine_mean + Padavine_sum + Temperatura_lokacija_max + Temperatura_lokacija_min
, learn)
predictions <- predict(bm, test)
predicted <- predictions$class
CA(test$PM10, predicted)
rf <- randomForest(PM10 ~ Sunki_vetra_max + Padavine_mean + Padavine_sum + Temperatura_lokacija_max + Temperatura_lokacija_min, learn)
predicted <- predict(rf, test, type = "class")
CA(test$PM10, predicted)
bag <- bagging(PM10 ~ Sunki_vetra_max + Padavine_mean + Padavine_sum + Temperatura_lokacija_max + Temperatura_lokacija_min, learn, nbagg=15)
bag.pred <- predict(bag, test, type="class")
CA(test$PM10, bag.pred)
modelDT <- CoreModel(PM10 ~ Sunki_vetra_max + Padavine_mean + Padavine_sum + Temperatura_lokacija_max + Temperatura_lokacija_min, learn, model="tree")
modelNB <- CoreModel(PM10 ~ Sunki_vetra_max + Padavine_mean + Padavine_sum + Temperatura_lokacija_max + Temperatura_lokacija_min, learn, model="bayes")
modelKNN <- CoreModel(PM10 ~ Sunki_vetra_max + Padavine_mean + Padavine_sum + Temperatura_lokacija_max + Temperatura_lokacija_min, learn, model="knn", kInNN = 5)
predDT <- predict(modelDT, test, type = "class")
predNB <- predict(modelNB, test, type="class")
predKNN <- predict(modelKNN, test, type="class")
pred <- data.frame(predDT, predNB, predKNN)
pred
predicted <- voting(pred)
CA(test$PM10, predicted)
predDT.prob <- predict(modelDT, test, type="probability")
predNB.prob <- predict(modelNB, test, type="probability")
predKNN.prob <- predict(modelKNN, test, type="probability")
pred.prob <- caDT * predDT.prob + caNB * predNB.prob + caKNN * predKNN.prob
pred.prob
predicted <- levels(learn$PM10)[apply(pred.prob, 1, which.max)]
CA(test$PM10, predicted)
q()
